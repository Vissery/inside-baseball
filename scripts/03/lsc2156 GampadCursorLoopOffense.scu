; LSC2 3 2156 GampadCursorLoopOffense

local variable local0
local variable local1
local variable local2
local variable local3
local variable local4
local variable local5
local variable local6

gRunnerCursorIndex = NONE
if (gStealing) {
    for local1 = 0 to 3 ++ {
        if (gRunners[local1][R-STATE] == R-STEALING) {
            gRunnerCursorIndex = local1
            local1 = 3 + 1
        }
    }
    gRunnerCursorDestinationBase = gRunners[gRunnerCursorIndex][R-DEST-BASE]
} else {
    for local1 = 0 to 3 ++ {
        if (gRunners[local1][R-KID] == gBatterKid) {
            gRunnerCursorIndex = local1
            local1 = 3 + 1
        }
    }
    gRunnerCursorDestinationBase = FIRST
}
run-script DrawNameUnderRunner [gRunnerCursorIndex]
do {
    local0 = call-script GetInputButtons [BUTTONS-GAME-PAD]
    if (16 & local0 > 0) {
        if (gRunnerCursorIndex != NONE) {
            local2 = gRunnersExtra[gRunnerCursorIndex][RE-SPRINT]
            if (local2) {
                if (local2 == 1) {
                    local2 = 6
                } else if (local2 < 30) {
                    local2 = local2 + 3
                }
            } else {
                local2 = 1
            }
            gRunnersExtra[gRunnerCursorIndex][RE-SPRINT] = local2
            sleep 2
        }
    }
    if (32 & local0 > 0) {
        if (gNumRunners >= 1) {
            if (gRunnerCursorIndex != NONE) {
                local1 = 0
                local3 = 0
                while (gBases[local1][BASE-RUNNERIDX] != gRunnerCursorIndex) {
                    local1 = iif (local1 == 4) 0 (local1 + 1)
                    ++local3
                    if (local3 > 10) {
                        local1 = -1
                        goto label0160
                    }
                }
            } else {
                local1 = -1
            }
label0160:
            do {
                local1 = iif (local1 == 4) 0 (local1 + 1)
            } until (gBases[local1][BASE-RUNNERIDX] != NONE)
            gRunnerCursorIndex = gBases[local1][BASE-RUNNERIDX]
            gRunnerCursorDestinationBase = gRunners[gRunnerCursorIndex][R-DEST-BASE]
            run-script DrawNameUnderRunner [gRunnerCursorIndex]
        }
        sleep 3
    }
    if (15 & local0) {
        if (gRunnerCursorIndex != NONE) {
            local4 = gRunners[gRunnerCursorIndex][R-CUR-BASE]
            local5 = gRunners[gRunnerCursorIndex][R-DEST-BASE]
            if (local5 == 999) {
                local5 = local4
            } else if (gRunners[gRunnerCursorIndex][R-DIRECTION] == BACKWARD) {
                local5 = local4
            }
            case 1 {
                of 1 & local0 > 0 {
                    local6 = 3
                }
                of 2 & local0 > 0 {
                    local6 = 1
                }
                of 4 & local0 > 0 {
                    local6 = 2
                }
                of 8 & local0 > 0 {
                    local6 = 4
                }
            }
            if (gRunners[gRunnerCursorIndex][R-DIRECTION]) {
                if (local6 > local5 && gRunners[gRunnerCursorIndex][R-DIRECTION] != BACKWARD) {
                    goto label02b0
                }
                if (local6 < local5 && gRunners[gRunnerCursorIndex][R-DIRECTION] != FORWARD) {
                    goto label02b0
                }
            } else if ((abs (local6 - local5)) == 1) {
                gRunnerCursorDestinationBase = local6
                run-script maybe_handle_basepath_click [2]
            }
        }
label02b0:
        sleep 3
    }
    stop-script
}
free-script
